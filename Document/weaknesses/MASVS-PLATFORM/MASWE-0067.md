---
title: 無効化されていないデバッグ可能フラグ (Debuggable Flag Not Disabled)
id: MASWE-0067
alias: debuggable-flag
platform: [android, ios]
profiles: [R]
mappings:
  masvs-v1: [MSTG-RESILIENCE-2]
  masvs-v2: [MASVS-RESILIENCE-4]
  android-risks:
  - https://developer.android.com/privacy-and-security/risks/android-debuggable
  cwe: [489]

refs:
- https://developer.android.com/guide/topics/manifest/application-element
status: new
---

## 概要

モバイルアプリは一般的にアプリがデバッグ可能かどうかを決定する設定フラグを含みます。このフラグは開発時には不可欠ですが、本番で有効なままにすると深刻なセキュリティリスクをもたらす可能性があります。デバッグ可能なアプリは、ルート化していないデバイスや脱獄していないデバイスであっても、攻撃者がデバッガをアタッチし、メモリを検査し、実行フローを操作し、クライアントサイドコントロールをバイパスすることを可能にします。また、詳細なログ記録や開発者ツールを通じてアクセス可能な機密情報を露出する可能性もあります。

## 影響

- **メモリの読み取りと改変**: 攻撃者はアプリのメモリ領域を読み取りおよび改変でき、暗号鍵、API キー、ユーザークレデンシャル、トークンなど、アプリのコードに存在せずディスクに保存されていないためアクセスできない機密情報の開示につながる可能性があります。
- **セキュリティコントロールのバイパス**: 攻撃者は、アプリの実行フローを操作することで、認証や認可のメカニズムなどのセキュリティコントロールをバイパスできます。
- **不正コードの実行**: 攻撃者はアプリのコンテキスト内に任意のコードを注入して実行し、デバイスやアプリのデータのさらなる悪用につながる可能性があります。たとえば、ルート化されていないデバイスや脱獄されていないデバイスであっても、攻撃者は Frida などのリバースエンジニアツールをアプリに注入できます。
- **機密ログへのアクセス**: 攻撃者は、ユーザークレデンシャル、API キー、その他の機密データなど、通常はアクセスできない機密情報を含む可能性のあるログにアクセスできます。これはアプリやデバイスのさらなる悪用につながる可能性があります。

## 流入の形態

- **ビルド設定の構成ミス**: ビルド設定の構成ミスは、誤ってアプリがデバッグ可能な状態のままとなり、セキュリティ上の脆弱性にさらされる可能性があります。これは、ビルドバリアントの不適切な選択、CI/CD 構成のエラー、本番環境へのデバッグ設定の誤った適用などから生じる可能性があります。

## 緩和策

- アプリの構成ファイルのデバッグ可能フラグが本番ビルドで有効になっていないことを確認します。たとえば、ビルドバリアントやフレーバーを使用してデバッグ構成とリリース構成を分離することで、デバッグ可能フラグがデバッグビルドでのみ有効になっていることを確認します。
